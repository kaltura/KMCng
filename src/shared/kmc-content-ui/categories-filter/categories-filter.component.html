<div class="kUseKMCngIcons">
    <div class="kHeader">
        <p-autoComplete width="300px" [(ngModel)]="currentSearch" [suggestions]="filteredSearchCategories" (completeMethod)="categorySearch($event)" field="label" placeholder="Find Category" [minLength]="3" (onSelect)="categorySelected($event)"></p-autoComplete>
        <i #config class="kIcongear kTreeConfig"></i>
        <p class="kAllCategories">ALL CATEGORIES {{searchCategories.length && !lazyLoading ? searchCategories.length : ''}}</p>
    </div>
    <div class="kTreeContainer">
        <p-tree [autoSelectChildren]="autoSelectChildren" [value]="categories" selectionMode="checkbox" [(selection)]="selectedCategories" (onNodeSelect)="onCategorySelectionChange($event)" (onNodeUnselect)="onCategorySelectionChange($event)">
        <template let-node  pTemplate type="default">
            <span class="kTreeNodeLabel">{{node.label}}</span>
            <span class="kTreeNodeNumChildren" *ngIf="node.children && node.children.length">{{node.children.length}}</span>
        </template>
        </p-tree>
    </div>

    <p>
        <a [class.disabled]="selectedCategories.length === 0" (click)="clearAll()">Clear all</a>
        <a class="kClose" (click)="close()">Close</a>
    </p>
</div>
<kPopupWidget #categoriesPref [popupWidth]="360" [popupHeight]="200" [closeBtn]="true" [targetRef]="config" [targetOffset]="{'x':-322, 'y': -24}" [parentPopup]="parentPopupWidget">
    <div class="kPrefs">
        <p class="kFilterPrefs">FILTER PREFERENCES</p>
    </div>
</kPopupWidget>
