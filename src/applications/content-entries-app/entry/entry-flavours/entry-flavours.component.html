<k-area-blocker [showLoader]="_handler.showSectionLoader" [message]="_handler.sectionBlockerMessage">
	<kFileDialog #fileDialog (onFileSelected)="_onFileSelected($event)" [filter]="_uploadFilter"></kFileDialog>
	<div class="kFlavours kUseKMCngIcons" #flavors>
		<p class="kTitle">{{'applications.content.entryDetails.flavours.flavours' | translate}}</p>
		<div class="kEntryStatus">
			<i class="{{_handler._entryStatusClassName}}"></i><span>{{_handler._entryStatus}}</span>
		</div>
		<!--button type="button" class="kButtonDefault" pButton icon="kIcondropdown_arrow_bottom" iconPos="right" label="{{'applications.content.entryDetails.flavours.replace' | translate}}"></button-->
		<div>
			<button pButton class="kButtonDefault kRefreshBtn small" type="text" icon="kIconrefresh" (click)="_handler._refresh()"></button>
		</div>

		<div class="kTable">
			<p-dataTable [value]="(_handler._flavors$ | async)?.items" scrollable="true" scrollHeight="100%">
				<p-column field="name" header="{{'applications.content.entryDetails.flavours.flavour' | translate}}" [style]="{'width':'120px'}">
				</p-column>
				<p-column field="id" header="{{'applications.content.entryDetails.flavours.assetId' | translate}}" [style]="{'width':'100px'}">
				</p-column>
				<p-column field="format" header="{{'applications.content.entryDetails.flavours.format' | translate}}">
				</p-column>
				<p-column field="codec" header="{{'applications.content.entryDetails.flavours.codec' | translate}}">
				</p-column>
				<p-column field="bitrate" header="{{'applications.content.entryDetails.flavours.bitrate' | translate}}">
				</p-column>
				<p-column field="dimensions" header="{{'applications.content.entryDetails.flavours.dimensions' | translate}}">
				</p-column>
				<p-column field="size" header="{{'applications.content.entryDetails.flavours.size' | translate}}">
				</p-column>
				<p-column field="statusLabel" header="{{'applications.content.entryDetails.flavours.stat' | translate}}">
					<template let-col let-flavor="rowData" pTemplate="body">
						<span [kTooltip]="flavor.statusTooltip" [class.kFlavorStatusError]="flavor.status === '-1'">{{flavor.statusLabel}}</span>
					</template>
				</p-column>
				<p-column field="tags" header="{{'applications.content.entryDetails.flavours.tags' | translate}}">
				</p-column>
				<p-column [style]="{'width':'80px'}">
					<template let-col let-flavor="rowData" pTemplate="body">
						<div *ngIf="flavor.status !== '1' && flavor.status !== '6' && flavor.status !== '7' && flavor.status !== '8' && flavor.status !== '0'" class="kFlavorsTableActions">
							<button type="button" pButton icon="kIconmore" (click)="openActionsMenu($event, flavor)"></button>
						</div>
						<div *ngIf="flavor.status === '1' || flavor.status === '6' || flavor.status === '7' || flavor.status === '8' || flavor.status === '0'" style="position: relative">
							<div class="k-spinner-background">
								<div class="k-spinner-animation"></div>
							</div>

						</div>
					</template>
				</p-column>
			</p-dataTable>
			<p-menu kMenuCloseOnScroll [scrollTarget]="flavors" #actionsmenu popup="popup" [model]="_actions" [appendTo]="'body'"></p-menu>
		</div>
	</div>

	<kPopupWidget #drmPopup [popupWidth]="550" [popupHeight]="440" [modal]="true">
		<kDRMDetails [currentFlavor]="_selectedFlavor"></kDRMDetails>
	</kPopupWidget>

	<kPopupWidget #previewPopup [popupWidth]="500" [popupHeight]="640" [modal]="true">
		<kFlavorPreview [currentFlavor]="_selectedFlavor" [parentPopupWidget]="previewPopup" [currentEntry]="_handler.data"></kFlavorPreview>
	</kPopupWidget>

	<kPopupWidget #importPopup [popupWidth]="500" [popupHeight]="240" [modal]="true">
		<kFlavorImport [currentFlavor]="_selectedFlavor" [parentPopupWidget]="importPopup"></kFlavorImport>
	</kPopupWidget>

	<p-growl [value]="_handler._msgs"></p-growl>
	<p-confirmDialog header="{{'applications.content.entryDetails.flavours.deleteConfirmTitle' | translate}}" width="450"></p-confirmDialog>
</k-area-blocker>
